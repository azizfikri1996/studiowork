!function(){"use strict";var e={link:HTMLLinkElement,script:HTMLScriptElement,img:HTMLImageElement};function n(e,n){for(var t="",r=0;r<n.length;r++)if(-1!==e.indexOf(n[r])){t=n[r];break}return t||e}var t={max:3,type:Object.keys(e),domain:[],crossOrigin:!1};function r(n,t){var r,i=t.target,a=null===(r=i.tagName)||void 0===r?void 0:r.toLocaleLowerCase(),o=n.type,c=function(e){return e instanceof HTMLScriptElement||e instanceof HTMLImageElement?e.src:e instanceof HTMLLinkElement?e.href:null}(i);return!!(a&&-1!==o.indexOf(a)&&e[a]&&i instanceof e[a]&&c)&&{target:i,tagName:a,url:c}}var i=/[?#].*$/;function a(e){return e.replace(i,"")}function o(e,t){var i,o=r(e,t);if(!1!==o){var c=o.target,s=o.tagName,u=o.url;if("undefined"==typeof window||!Object.keys(window.__RB_ASYNC_CHUNKS__||{}).some((function(e){return-1!==u.indexOf(e)}))){var d=e.test;if(d){if("string"==typeof d){var l=new RegExp(d);d=function(e){return l.test(e)}}if("function"!=typeof d||!d(u))return}var m=n(u,e.domain);if(!(e.domain&&e.domain.length>0&&-1===e.domain.indexOf(m))){var f=Number(c.dataset.rsbuildRetryTimes)||0;if(f!==e.max){var y=function(e,t){var r=n(e,t),i=t.indexOf(r);return t[(i+1)%t.length]||e}(m,e.domain),g=null!==(i=c.dataset.rsbuildOriginalQuery)&&void 0!==i?i:function(e){var n=e.split("?")[1];return n?"?".concat(n.split("#")[0]):""}(u),p=Boolean(c.dataset.rsbuildAsync)||c.async||c.defer,v={url:a(u.replace(m,y))+function(n){return!0===e.addQuery?""!==g?"".concat(g,"&retry=").concat(n):"?retry=".concat(n):"function"==typeof e.addQuery?e.addQuery({times:n,originalQuery:g}):""}(f+1),times:f+1,crossOrigin:e.crossOrigin,isAsync:p,originalQuery:g},b=function(e,n){var t=!0===n.crossOrigin?"anonymous":n.crossOrigin,r=t?'crossorigin="'.concat(t,'"'):"",i=n.times?'data-rsbuild-retry-times="'.concat(n.times,'"'):"",a=n.originalQuery?'data-rsbuild-original-query="'.concat(n.originalQuery,'"'):"",o=n.isAsync?"data-rsbuild-async":"";if(e instanceof HTMLScriptElement){var c=document.createElement("script");return c.src=n.url,t&&(c.crossOrigin=t),n.times&&(c.dataset.rsbuildRetryTimes=String(n.times)),n.isAsync&&(c.dataset.rsbuildAsync=""),void 0!==n.originalQuery&&(c.dataset.rsbuildOriginalQuery=n.originalQuery),{element:c,str:'<script src="'.concat(n.url,'" ').concat(r," ").concat(i," ").concat(o," ").concat(a,">")+"<\/script>"}}if(e instanceof HTMLLinkElement){var s=document.createElement("link");return s.rel=e.rel||"stylesheet",e.as&&(s.as=e.as),s.href=n.url,t&&(s.crossOrigin=t),n.times&&(s.dataset.rsbuildRetryTimes=String(n.times)),void 0!==n.originalQuery&&(s.dataset.rsbuildOriginalQuery=n.originalQuery),{element:s,str:'<link rel="'.concat(s.rel,'" href="').concat(n.url,'" ').concat(r," ").concat(i," ").concat(s.as?'as="'.concat(s.as,'"'):""," ").concat(a,"></link>")}}}(c,v);if(e.onRetry&&"function"==typeof e.onRetry){var E={times:f,domain:m,url:u,tagName:s};e.onRetry(E)}!function(e,n,t){e instanceof HTMLScriptElement&&(t.isAsync?document.body.appendChild(n.element):document.write(n.str)),e instanceof HTMLLinkElement&&document.getElementsByTagName("head")[0].appendChild(n.element),e instanceof HTMLImageElement&&(e.src=t.url,e.dataset.rsbuildRetryTimes=String(t.times),e.dataset.rsbuildOriginalQuery=String(t.originalQuery))}(c,b,v)}else if("function"==typeof e.onFail){var L={times:f,domain:m,url:u,tagName:s};e.onFail(L)}}}}}!function(e){var i={};for(var a in t)i[a]=t[a];for(var c in e)i[c]=e[c];Array.isArray(i.type)&&0!==i.type.length||(i.type=t.type),Array.isArray(i.domain)&&0!==i.domain.length||(i.domain=t.domain),Array.isArray(i.domain)&&(i.domain=i.domain.filter(Boolean)),"undefined"==typeof window||window.__RB_ASYNC_CHUNKS__||(window.__RB_ASYNC_CHUNKS__={});try{!function(e,n){"undefined"!=typeof window&&void 0!==window.document&&(document.addEventListener("error",(function(n){n&&n.target instanceof Element&&e(n)}),!0),document.addEventListener("load",(function(e){e&&e.target instanceof Element&&n(e)}),!0))}((function(e){try{o(i,e)}catch(e){console.error("retry error captured",e)}}),(function(e){try{!function(e,t){var i=r(e,t);if(!1!==i){var a=i.target,o=i.tagName,c=i.url,s=n(c,e.domain),u=Number(a.dataset.rsbuildRetryTimes)||0;if(0!==u&&"function"==typeof e.onSuccess){var d={times:u,domain:s,url:c,tagName:o};e.onSuccess(d)}}}(i,e)}catch(e){console.error("load error captured",e)}}))}catch(e){console.error("monitor error captured",e)}}({crossOrigin:!1})}();